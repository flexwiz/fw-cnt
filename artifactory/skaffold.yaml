apiVersion: skaffold/v4beta5
kind: Config
metadata:
  name: artifactory
profiles:
  - name: dev
    activation:
      - kubeContext: minikube
    deploy: &artifactory_deploy
      helm:
        releases:
          - name: artifactory
            # https://github.com/jfrog/helm-charts/tree/master/charts/jfrog-artifactory-oss
            # https://artifacthub.io/packages/helm/jfrog/artifactory-oss
            repo: https://charts.jfrog.io
            remoteChart: artifactory-oss
            valuesFiles:
              - ./k8s/artifactory-values.yaml
    portForward: &artifactory_port_forward
      - resourceType: service
        resourceName: artifactory
        port: 8080
        localPort: 8080

  - name: dev-gcp
    deploy: *artifactory_deploy
    portForward: *artifactory_port_forward
    build:
      googleCloudBuild:
        projectId: ezloc-dev
        concurrency: 0
    activation:
      - kubeContext: europe-west9-b_ezloc-dev-europe-west9-b_k8s-cluster
