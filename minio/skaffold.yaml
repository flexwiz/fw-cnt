apiVersion: skaffold/v4beta5
kind: Config
metadata:
  name: minio
profiles:
  - name: dev
    activation:
      - kubeContext: minikube
    deploy: &minio_deploy
      helm:
        releases:
          - name: minio
            repo: https://charts.bitnami.com/bitnami
            version: 12.1.10
            remoteChart: minio
            setValues:
              auth.rootUser: "admin"
              auth.rootPassword: "password"
              defaultBuckets: 'datas:private public download upload images ezloc-data-bucket'
    portForward: &minio_port_forward
      - resourceType: service
        resourceName: minio
        port: 9000
        localPort: 9000
      - resourceType: service
        resourceName: minio
        port: 9001
        localPort: 9001

  - name: dev-gcp
    deploy: *minio_deploy
    portForward: *minio_port_forward
    build:
      googleCloudBuild:
        projectId: "ntdt-dev"
        concurrency: 0
    activation:
      - kubeContext: gke_ntdt-dev_europe-west1-b_ntdt-dev-k8s-cluster
