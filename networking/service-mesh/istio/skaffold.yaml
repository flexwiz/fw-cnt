apiVersion: skaffold/v4beta11
kind: Config
metadata:
  name: istio-ingress

# Environments: development, staging, production
profiles:
  - name: development
    build:
      tagPolicy:
        sha256: {}
    deploy: &deploy
      kubectl: {}
      kubeContext: minikube
    manifests:
      rawYaml:
        - ./k8s/*.yaml
      # kustomize:
      #   paths:
      #     - k8s/overlays/development
      #     # - helm/overlays/development
    # portForward: &portForward
    #   - resourceType: service
    #     resourceName: istiod
    #     namespace: istio-system
    #     port: 15014
    #     localPort: 8280

  - name: staging
    deploy: *deploy
    manifests:
      kustomize:
        paths:
          - ./k8s/overlays/staging
          # - ./helm/overlays/staging

  - name: production
    deploy: *deploy
    manifests:
      kustomize:
        paths:
          - ./k8s/overlays/production
          # - ./helm/overlays/production
