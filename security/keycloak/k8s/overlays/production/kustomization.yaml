# overlays/production/kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: fw-security

labels:
- includeSelectors: true
  pairs:
    flexwiz.io/env: production

resources:
- ../../base
- hpa.yaml
- networkpolicy.yaml
- cronjob-backup.yaml
# - servicemonitor.yaml

patches:
- path: patches/metabase-deployment-patch.yaml
- path: patches/metabase-config-patch.yaml
- path: patches/metabase-ingress-patch.yaml
- path: patches/postgres-resources-patch.yaml

images:
- name: metabase/metabase
  newTag: "v0.45.0"

secretGenerator:
- envs:
  - secrets/db-credentials.env
  name: metabase-db-credentials
  type: Opaque

