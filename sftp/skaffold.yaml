apiVersion: skaffold/v4beta5
kind: Config
metadata:
  name: sftp
profiles:
  - name: dev
    activation:
      - kubeContext: minikube
    deploy:
      helm:
        releases:
          - name: sftp
            remoteChart: sftp
            setValues:
              configuration.Global.Chroot.Directory: "%h"
              configuration.Global.Chroot.StartPath: out
              configuration.Global.Directories.0: out
              configuration.Users.0.Password: dev
              configuration.Users.0.Username: dev
            repo: https://emberstack.github.io/helm-charts
    portForward:
      - resourceType: service
        resourceName: sftp
        port: 22
        localPort: 15000

  - name: dev-gcp
    activation:
      - kubeContext: gke_ntdt-dev_europe-west1-b_ntdt-dev-k8s-cluster
    build:
      googleCloudBuild:
        projectId: ntdt-dev
    deploy:
      helm:
        releases:
          - name: sftp
            remoteChart: sftp
            setValues:
              configuration.Global.Chroot.Directory: "%h"
              configuration.Global.Chroot.StartPath: out
              configuration.Global.Directories.0: out
              configuration.Users.0.Password: dev
              configuration.Users.0.Username: dev
            repo: https://emberstack.github.io/helm-charts
    portForward:
      - resourceType: service
        resourceName: sftp
        port: 22
        localPort: 15000
