apiVersion: skaffold/v4beta5
kind: Config
metadata:
  name: common-tools

requires:
  - configs: ["artifactory"]
    path: ./artifactory
    activeProfiles: &profiles
      - name: minikube
        activatedBy: [minikube]
      - name: gcp
        activatedBy: [gcp]
  - configs: ["keycloak"]
    path: ./keycloak
    activeProfiles: *profiles
  - configs: ["minio"]
    path: ./minio
    activeProfiles: *profiles
  - configs: ["mongodb"]
    path: ./mongodb
    activeProfiles: *profiles
  - configs: ["postgres"]
    path: ./postgres
    activeProfiles: *profiles
  - configs: ["redis"]
    path: ./redis
    activeProfiles: *profiles
  - configs: ["sftp"]
    path: ./sftp
    activeProfiles: *profiles
  - configs: ["superset"]
    path: ./superset
    activeProfiles: *profiles

profiles:
  - name: minikube
    build:
      local:
        concurrency: 0
        useBuildkit: true
    activation:
      - kubeContext: minikube
  - name: gcp
    build:
      googleCloudBuild:
        workerPool: projects/ezloc/locations/europe-west9/workerPools/development-pool
        projectId: ezloc-02
        concurrency: 0
    activation:
      - kubeContext: gke_ezloc-02_europe-west9-b_development-cluster
